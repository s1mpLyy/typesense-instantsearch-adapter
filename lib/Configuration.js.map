{"version":3,"file":"Configuration.js","names":["_interopRequireDefault","require","Object","defineProperty","exports","value","Configuration","_classCallCheck2","_createClass2","_this$server$cacheSea","_options$additionalSe","_ref","_this$additionalSearc","_ref2","_this$additionalSearc2","_ref3","_this$additionalSearc3","_ref4","_this$additionalSearc4","_options$geoLocationF","_options$facetableFie","_options$queryEnhance","_options$collectionSp","_this","_options$flattenGroup","_options$facetByOptio","_options$filterByOpti","_options$sortByOption","_options$collectionSp2","_options$collectionSp3","_options$collectionSp4","options","arguments","length","undefined","server","nodes","host","port","path","protocol","cacheSearchResultsForSeconds","additionalSearchParameters","query_by","queryBy","preset","sort_by","sortBy","highlight_full_fields","highlightFullFields","geoLocationField","facetableFieldsWithSpecialCharacters","queryEnhancement","enabled","url","timeout","collectionSpecificSearchParameters","keys","forEach","collection","_params$queryBy","_params$preset","_params$sortBy","_ref5","_ref6","_params$highlightFull","params","key","renderingContent","flattenGroupedHits","facetByOptions","filterByOptions","sortByOptions","collectionSpecificFacetByOptions","collectionSpecificFilterByOptions","collectionSpecificSortByOptions","validate","values","some","c","console","warn","Error"],"sources":["../src/Configuration.js"],"sourcesContent":["\"use strict\";\n\nexport class Configuration {\n  constructor(options = {}) {\n    this.server = options.server || {\n      nodes: [\n        {\n          host: \"localhost\",\n          port: \"8108\",\n          path: \"\",\n          protocol: \"http\",\n        },\n      ],\n    };\n\n    this.server.cacheSearchResultsForSeconds = this.server.cacheSearchResultsForSeconds ?? 2 * 60;\n\n    this.additionalSearchParameters = options.additionalSearchParameters ?? {};\n\n    this.additionalSearchParameters.query_by =\n      this.additionalSearchParameters.queryBy ?? this.additionalSearchParameters.query_by ?? \"\";\n\n    this.additionalSearchParameters.preset =\n      this.additionalSearchParameters.preset ?? this.additionalSearchParameters.preset ?? \"\";\n\n    this.additionalSearchParameters.sort_by =\n      this.additionalSearchParameters.sortBy ?? this.additionalSearchParameters.sort_by ?? \"\";\n\n    this.additionalSearchParameters.highlight_full_fields =\n      this.additionalSearchParameters.highlightFullFields ??\n      this.additionalSearchParameters.highlight_full_fields ??\n      this.additionalSearchParameters.query_by;\n\n    this.geoLocationField = options.geoLocationField ?? \"_geoloc\";\n    this.facetableFieldsWithSpecialCharacters = options.facetableFieldsWithSpecialCharacters ?? [];\n\n    /**\n     * Query Enhancement Configuration\n     *\n     * Allows enhancing search queries through an external API before sending to Typesense.\n     * This is useful for query expansion, spell correction, or language-specific processing.\n     *\n     * @param {boolean} enabled - Enable/disable query enhancement (default: false)\n     * @param {string} url - Enhancement API endpoint URL\n     * @param {number} timeout - Request timeout in milliseconds (default: 5000)\n     *\n     * @example\n     * queryEnhancement: {\n     *   enabled: true,\n     *   url: \"https://api.example.com/enhance\",\n     *   timeout: 3000\n     * }\n     */\n    this.queryEnhancement = options.queryEnhancement ?? {\n      enabled: false,\n      url: \"https://arhhm5omsof3nkzctfctb5fcl40wdiya.lambda-url.eu-central-1.on.aws\",\n      timeout: 5000,\n    };\n\n    this.collectionSpecificSearchParameters = options.collectionSpecificSearchParameters ?? {};\n\n    Object.keys(this.collectionSpecificSearchParameters).forEach((collection) => {\n      const params = this.collectionSpecificSearchParameters[collection];\n      params.query_by = params.queryBy ?? params.query_by;\n      params.preset = params.preset ?? params.preset;\n      params.sort_by = params.sortBy ?? params.sort_by;\n      params.highlight_full_fields =\n        params.highlightFullFields ??\n        params.highlight_full_fields ??\n        this.additionalSearchParameters.highlight_full_fields ??\n        params.query_by;\n\n      // Remove undefined values\n      Object.keys(params).forEach((key) => (params[key] === undefined ? delete params[key] : {}));\n    });\n\n    this.renderingContent = options.renderingContent;\n    this.flattenGroupedHits = options.flattenGroupedHits ?? true;\n    this.facetByOptions = options.facetByOptions ?? {};\n    this.filterByOptions = options.filterByOptions ?? {};\n    this.sortByOptions = options.sortByOptions ?? {};\n    this.collectionSpecificFacetByOptions = options.collectionSpecificFacetByOptions ?? {};\n    this.collectionSpecificFilterByOptions = options.collectionSpecificFilterByOptions ?? {};\n    this.collectionSpecificSortByOptions = options.collectionSpecificSortByOptions ?? {};\n  }\n\n  validate() {\n    // Warn if camelCased parameters are used, suggest using snake_cased parameters instead\n    if (\n      this.additionalSearchParameters.queryBy ||\n      Object.values(this.collectionSpecificSearchParameters).some((c) => c.queryBy)\n    ) {\n      console.warn(\n        \"[typesense-instantsearch-adapter] Please use snake_cased versions of parameters in additionalSearchParameters instead of camelCased parameters. For example: Use query_by instead of queryBy. camelCased parameters will be deprecated in a future version.\" +\n          \" We're making this change so that parameter names are identical to the ones sent to Typesense (which are all snake_cased), and to also keep the types for these parameters in sync with the types defined in typesense-js.\",\n      );\n    }\n\n    /*\n     * Either additionalSearchParameters.query_by or additionalSearchParameters.preset needs to be set, or\n     *   All collectionSpecificSearchParameters need to have query_by or preset\n     *\n     * */\n    if (\n      this.additionalSearchParameters.query_by.length === 0 &&\n      this.additionalSearchParameters.preset.length === 0 &&\n      (Object.keys(this.collectionSpecificSearchParameters).length === 0 ||\n        Object.values(this.collectionSpecificSearchParameters).some(\n          (c) => (c.query_by || \"\").length === 0 && (c.preset || \"\").length === 0,\n        ))\n    ) {\n      throw new Error(\n        \"[typesense-instantsearch-adapter] Missing parameter: One of additionalSearchParameters.query_by or additionalSearchParameters.preset needs to be set, or all collectionSpecificSearchParameters need to have either .query_by or .preset set.\",\n      );\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]}